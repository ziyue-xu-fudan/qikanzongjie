我将创建一个全新的应用 `app_multi_threading.py`，严格遵循 **"一杂志一 Key，四路并发"** 的架构，并彻底解决之前的稳定性问题。

### **核心架构：稳定并发四重奏**

为了确保“快”且“稳”，我将采用以下技术方案：

1.  **主线程预处理 (关键修复)**:
    *   **文件读取**: 在启动并发前，主线程**一次性读取所有 Excel 文件**。这彻底消除了 `openpyxl` 在多线程下的 `Worksheet index` 报错。
    *   **Entrez 预热**: 启动前先执行一次虚拟查询，生成缓存文件。这彻底消除了 `Biopython` 的 DTD 写入冲突。

2.  **文件级并发 (File-Level Concurrency)**:
    *   启动 **4 个独立线程**。
    *   每个线程绑定：`1 个 DataFrame (杂志)` + `1 个 API Key`。
    *   这 4 个任务**同时运行**，互不干扰，最大化利用 4 个 Key 的吞吐量。

3.  **结果汇聚**:
    *   主线程监控任务状态，每当一个杂志处理完成，立即在界面上展示结果。

### **可视化：三组高级图表**

分析完成后，将自动生成深度洞察报告：

*   **📊 图表组 1: 研究全景 (Research Landscape)**
    *   Panel 1: **各杂志研究设计构成** (堆叠柱状图) - 看看 NEJM 是否更偏爱 RCT？
    *   Panel 2: **时序类型分布** (环形图) - 前瞻性研究占比。
    *   Panel 3: **设计 x 时序热力图** (Heatmap) - 揭示方法学组合规律。

*   **🏥 图表组 2: 临床焦点 (Clinical Focus)**
    *   Panel 1: **疾病系统分布树** (Treemap) - 心血管 vs 肿瘤 vs 神经...
    *   Panel 2: **Top 10 热门疾病** (条形图) - 具体的疾病排名。
    *   Panel 3: **疾病系统 x 杂志偏好** (桑基图或气泡图) - 哪个杂志是心血管之王？

*   **🌍 图表组 3: 全球视野 (Global View)**
    *   Panel 1: **全球产出热力地图** (World Map)。
    *   Panel 2: **Top 10 国家发文量** (柱状图)。
    *   Panel 3: **中国 vs 美国研究偏好对比** (雷达图) - 两国在研究类型上的差异。

### **执行计划**
1.  **创建 `app_multi_threading.py`**: 实现上述并发架构。
2.  **默认配置**: 预填您提供的 4 个 Key，默认对应 4 个文件。
3.  **实现图表**: 集成 Plotly 绘制上述 9-10 个 Panel。
